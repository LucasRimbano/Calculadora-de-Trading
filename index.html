<!-- filepath: investment-calculator/index.html -->
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>💸 Calculadora de retorno de pérdidas/ganancias | 📈 Gráfico TradingView</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1 style="text-align:center; margin-top:32px;">💸 Calculadora de retorno de pérdidas/ganancias 📊</h1>
  <div class="main-wrapper">
    <div></div> <!-- Columna vacía para empujar la calculadora a la derecha -->
    <div class="container">
      <h2>💸 Calculadora de Inversión</h2>
      <h3 style="margin-bottom:16px;">📝 Datos a ingresar</h3>
      <form id="form-calculadora" onsubmit="event.preventDefault(); calcular();">
        <label for="entrada">🔽 Precio de entrada:</label>
        <input type="number" id="entrada" step="0.01">

        <label for="salida">🔼 Precio de salida:</label>
        <input type="number" id="salida" step="0.01">

        <label for="posicion">💵 Posición en dólares:</label>
        <input type="number" id="posicion" step="0.01">

        <button type="submit">🧮 Calcular</button>
        <div id="resultado"></div>
        <button id="limpiar" type="button" style="margin-top:12px; display:none;" onclick="limpiarCampos()">🔄 Limpiar</button>
      </form>
    </div>
    <div class="chart-wrapper">
      <h3>📊 Gráfico de TradingView</h3>
      <div class="tradingview-widget-container">
        <div id="tradingview_12345"></div>
        <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
        <script type="text/javascript">
          new TradingView.widget({
            "width": 600,
            "height": 400,
            "symbol": "BINANCE:BTCUSDT", // Gráfico de Bitcoin
            "interval": "D",
            "timezone": "Etc/UTC",
            "theme": "light",
            "style": "1",
            "locale": "es",
            "toolbar_bg": "#f1f3f6",
            "enable_publishing": false,
            "allow_symbol_change": true,
            "container_id": "tradingview_12345"
          });
        </script>
      </div>
    </div>
  </div>
  <script>
    function calcular() {
      const entrada = parseFloat(document.getElementById("entrada").value);
      const salida = parseFloat(document.getElementById("salida").value);
      const posicion = parseFloat(document.getElementById("posicion").value);

      const unidades = posicion / entrada;
      const valorFinal = unidades * salida;
      const ganancia = valorFinal - posicion;
      const roi = (ganancia / posicion) * 100;

      let mensaje = "";
      if (roi > 0) {
        mensaje = "✅ Ganancia realizada";
      } else if (roi === 0) {
        mensaje = "🔄 Precio de entrada realizado";
      } else {
        mensaje = "❌ Pérdida realizada";
      }

      const resultadoHTML = `
        <h4 style="margin-bottom:10px;">${mensaje}</h4>
        <p>🔢 Unidades compradas: ${unidades.toFixed(2)}</p>
        <p>💰 Valor final: $${valorFinal.toFixed(2)}</p>
        <p>${ganancia >= 0 ? "📈" : "📉"} Ganancia/Pérdida: $${ganancia.toFixed(2)}</p>
        <p>📊 ROI: ${roi.toFixed(2)}%</p>
      `;
      document.getElementById("resultado").innerHTML = resultadoHTML;
      document.getElementById("limpiar").style.display = "block";
    }

    function limpiarCampos() {
      document.getElementById("entrada").value = "";
      document.getElementById("salida").value = "";
      document.getElementById("posicion").value = "";
      document.getElementById("resultado").innerHTML = "";
      document.getElementById("limpiar").style.display = "none";
    }
  </script>